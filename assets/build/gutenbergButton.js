(()=>{"use strict";var e={715:e=>{e.exports=window.wp.blockEditor}},t={};function s(a){var o=t[a];if(void 0!==o)return o.exports;var l=t[a]={exports:{}};return e[a](l,l.exports,s),l.exports}const a=window.wp.plugins,o=window.wp.editor,l=window.wp.components,i=window.wp.data,n=window.wp.element,r=window.wp.i18n,c=window.wp.primitives,p=window.ReactJSXRuntime,d=(0,p.jsx)(c.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,p.jsx)(c.Path,{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm.5 16c0 .3-.2.5-.5.5H5c-.3 0-.5-.2-.5-.5V7h15v12zM9 10H7v2h2v-2zm0 4H7v2h2v-2zm4-4h-2v2h2v-2zm4 0h-2v2h2v-2zm-4 4h-2v2h2v-2zm4 0h-2v2h2v-2z"})}),u=({settings:e,onSettingsChange:t,postTypes:a,statusChoices:o,originalPost:i,featuredImage:c,onFeaturedImageChange:u})=>{const[m,g]=(0,n.useState)((()=>{const t={...e};return"same"===e.type&&i?.type&&(t.type=i.type),"same"===e.status&&i?.status&&(t.status=i.status),t})()),[_,x]=(0,n.useState)(!1),[h,f]=(0,n.useState)(""),[y,S]=(0,n.useState)(""),[v,w]=(0,n.useState)(!1),j=window.postDuplicatorVars?.users||[],b=window.postDuplicatorVars?.currentUser,C=window.postDuplicatorVars?.postTypesAuthorSupport||{},[N,D]=(0,n.useState)((()=>{const e=i?.type;return!1!==C[e]?b?.id?String(b.id):j.length>0?j[0].value:"":""})()),[k,T]=(0,n.useState)(""),[P,M]=(0,n.useState)([]),[z,B]=(0,n.useState)((new Date).toISOString()),[E,V]=(0,n.useState)(""),{MediaUpload:I,MediaUploadCheck:$}=(()=>{try{const e=s(715);if(e&&e.MediaUpload&&e.MediaUploadCheck&&"function"==typeof e.MediaUpload&&"function"==typeof e.MediaUploadCheck)return{MediaUpload:e.MediaUpload,MediaUploadCheck:e.MediaUploadCheck}}catch(e){}return{MediaUpload:null,MediaUploadCheck:null}})();let U=!0;try{if(void 0!==window.wp&&window.wp.data&&"function"==typeof window.wp.data.select){const e=window.wp.data.select("core/editor");U=!e||"function"!=typeof e.getCurrentPost}}catch(e){U=!0}const H=e=>e.toLowerCase().trim().replace(/\s+/g,"-").replace(/[^\w\-]/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,""),A=e=>H(e),O=(e,s)=>{const a={...m,[e]:s};"timestamp"===e&&"custom"!==s&&(a.customDate=null),g(a),t(a)};(0,n.useEffect)((()=>{if(!v&&i?.title&&i?.slug){const s=e.fullTitle||`${i.title} ${e.title||""}`;f(s.trim());const a=e.fullSlug||`${i.slug}-${e.slug||"copy"}`;S(a);const o={...e,fullTitle:s.trim(),fullSlug:a};g(o),t(o);const l=i?.type;let n="";!1!==C[l]&&(n="current_user"===e.post_author?String(b?.id||""):String(i.authorId||b?.id||"")),D(n);const r=e.customDate||(new Date).toISOString();B(r),V(F(r));const c=i?.parent||0;T(c>0?String(c):""),O("selectedParentId",c>0?c:null),w(!0)}}),[i,v,e,b]),(0,n.useEffect)((()=>{(async()=>{if(!i?.type)return void M([]);const e="same"===m.type?i.type:m.type;try{const t=await fetch(`${window.postDuplicatorVars.restUrl}parent-posts?post_type=${e}&exclude_id=${i.id}`,{headers:{"X-WP-Nonce":window.postDuplicatorVars.nonce}});if(t.ok){const e=await t.json(),s=e=>{const t=e.level||0;return 0===t?e.title:`${"—".repeat(t)+" "}${e.title}`},a=[{label:(0,r.__)("— No Parent —","post-duplicator"),value:""},...e.map((e=>({label:s(e),value:String(e.id),level:e.level||0})))];M(a),i?.parentPost&&i.parent>0&&(e.some((e=>e.id===i.parent))||(a.splice(1,0,{label:i.parentPost.title,value:String(i.parent),level:0}),M(a)))}}catch(e){console.error("Error fetching parent posts:",e),M([{label:(0,r.__)("— No Parent —","post-duplicator"),value:""}])}})()}),[i?.type,m.type,i?.id,i?.parent,i?.parentPost]),(0,n.useEffect)((()=>{const t={...e};"same"===e.type&&i?.type&&(t.type=i.type),"same"===e.status&&i?.status&&(t.status=i.status),g(t)}),[e,i]),(0,n.useEffect)((()=>{if(!v)return;const e="same"===m.type?i?.type:m.type,t=!1!==C[e];if(t||""===N){if(t&&""===N&&b?.id){const e=String(b.id);D(e),O("selectedAuthorId",parseInt(e))}}else D(""),O("selectedAuthorId",null)}),[m.type,v]);const F=e=>new Date(e).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),R=e=>{const s=e instanceof Date?e.toISOString():new Date(e).toISOString();B(s),V(F(s));const a={...m,timestamp:"custom",customDate:s};g(a),t(a)},W=e=>Array.isArray(e)?e:Object.entries(e).map((([e,t])=>({value:e,label:t}))),J=()=>{if(void 0===window.wp||!window.wp.media)return console.error("WordPress media library is not available. Make sure wp_enqueue_media() is called."),void alert((0,r.__)("Media library is not available. Please refresh the page.","post-duplicator"));const e=window.wp.media({title:(0,r.__)("Select or Upload Featured Image","post-duplicator"),button:{text:(0,r.__)("Use this image","post-duplicator")},multiple:!1,library:{type:"image"}});e.on("select",(()=>{const t=e.state().get("selection").first().toJSON(),s={id:t.id,url:t.url,thumbnail:t.sizes?.thumbnail?.url||t.url,alt:t.alt||""};u&&u(s)})),e.open()},X=e=>{const t=c?.alt||"",s=c?.url?.split("/").pop()||"",a=`editor-post-featured-image-${c?.id||"new"}-describedby`,o=t||(0,r.__)("The current image has no alternative text.","post-duplicator")+(s?` ${(0,r.__)("The file name is:","post-duplicator")} ${s}`:"");return(0,p.jsxs)("div",{className:"editor-post-featured-image__container",children:[c&&(0,p.jsx)("div",{id:a,className:"hidden",children:o}),c?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(l.Button,{type:"button",className:"components-button editor-post-featured-image__preview is-next-40px-default-size",onClick:e,"aria-label":(0,r.__)("Edit or replace the featured image","post-duplicator"),"aria-describedby":a,"aria-haspopup":"dialog",children:(0,p.jsx)("img",{className:"editor-post-featured-image__preview-image",src:c.url,alt:o})}),(0,p.jsxs)(l.__experimentalHStack,{className:"editor-post-featured-image__actions",children:[(0,p.jsx)(l.Button,{type:"button",className:"components-button editor-post-featured-image__action is-next-40px-default-size",onClick:e,"aria-haspopup":"dialog",children:(0,r.__)("Replace","post-duplicator")}),(0,p.jsx)(l.Button,{type:"button",className:"components-button editor-post-featured-image__action is-next-40px-default-size",onClick:()=>{u&&u(null)},children:(0,r.__)("Remove","post-duplicator")})]})]}):(0,p.jsx)(l.Button,{variant:"secondary",onClick:e,__next40pxDefaultSize:!0,children:(0,r.__)("Set featured image","post-duplicator")}),l.DropZone&&(0,p.jsx)(l.DropZone,{onFilesDrop:t=>{t.length>0&&e()},className:"components-drop-zone",children:(0,p.jsx)("div",{className:"components-drop-zone__content",children:(0,p.jsxs)("div",{className:"components-drop-zone__content-inner",children:[(0,p.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",className:"components-drop-zone__content-icon","aria-hidden":"true",focusable:"false",children:(0,p.jsx)("path",{d:"M18.5 15v3.5H13V6.7l4.5 4.1 1-1.1-6.2-5.8-5.8 5.8 1 1.1 4-4v11.7h-6V15H4v5h16v-5z"})}),(0,p.jsx)("span",{className:"components-drop-zone__content-text",children:(0,r.__)("Drop files to upload","post-duplicator")})]})})})]})};return(0,p.jsxs)(l.__experimentalVStack,{className:"duplicate-settings-fields",spacing:"20px",children:[(0,p.jsxs)(l.__experimentalHStack,{spacing:"16px",alignment:"stretch",className:"duplicate-settings-fields__top",children:[(0,p.jsxs)(l.__experimentalVStack,{className:"duplicate-settings-fields__title",children:[(0,p.jsx)(l.TextControl,{label:(0,r.__)("Title","post-duplicator"),value:h,onChange:e=>{if(f(e),!_&&i?.title){const s=A(e);S(s);const a={...m,fullTitle:e,fullSlug:s};g(a),t(a)}else O("fullTitle",e)},__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0,style:{flex:1}}),(0,p.jsx)(l.TextControl,{label:(0,r.__)("Slug","post-duplicator"),value:y,onChange:e=>{S(e),x(!0),O("fullSlug",e)},onBlur:()=>{if(y&&""!==y.trim()){const e=H(y);S(e),O("fullSlug",e)}else{const e=A(h);S(e),O("fullSlug",e),x(!1)}},__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})]}),(0,p.jsx)("div",{className:"duplicate-settings-fields__featured-image",style:{minWidth:"200px",width:"35%",flex:"0 0 auto"},children:(()=>{if(!U&&I&&$)return(0,p.jsx)($,{children:(0,p.jsx)(I,{onSelect:e=>{const t={id:e.id,url:e.url,thumbnail:e.sizes?.thumbnail?.url||e.url,alt:e.alt||""};u&&u(t)},allowedTypes:["image"],value:c?.id,render:({open:e})=>X(e)})});try{return X((()=>J()))}catch(e){return console.error("Error rendering featured image UI:",e),(0,p.jsxs)("div",{children:[(0,p.jsxs)("p",{children:["Error rendering featured image UI: ",e.message]}),(0,p.jsx)(l.Button,{variant:"secondary",onClick:()=>J(),__next40pxDefaultSize:!0,children:(0,r.__)("Set featured image","post-duplicator")})]})}})()})]}),(0,p.jsxs)(l.__experimentalHStack,{spacing:"16px",alignment:"stretch",children:[(0,p.jsx)(l.SelectControl,{label:(0,r.__)("Post Type","post-duplicator"),value:m.type,options:W(a),onChange:e=>O("type",e),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,p.jsx)(l.SelectControl,{label:(0,r.__)("Post Status","post-duplicator"),value:m.status,options:W(o),onChange:e=>O("status",e),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,p.jsx)(l.SelectControl,{label:(0,r.__)("Post Parent","post-duplicator"),value:k||"",options:P,onChange:e=>{T(e),O("selectedParentId",e?parseInt(e):null)},__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})]}),(0,p.jsxs)(l.__experimentalHStack,{spacing:"16px",alignment:"stretch",children:[(0,p.jsx)(l.SelectControl,{label:(0,r.__)("Post Author","post-duplicator"),value:N||"",options:[{label:(0,r.__)("No Author","post-duplicator"),value:""},...j],onChange:e=>{D(e),O("selectedAuthorId",e?parseInt(e):null)},__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,p.jsxs)("div",{style:{flex:1,position:"relative"},children:[(0,p.jsx)(l.TextControl,{label:(0,r.__)("Post Date","post-duplicator"),value:E,onChange:e=>{V(e)},onBlur:()=>{try{const e=new Date(E);if(isNaN(e.getTime()))V(F(z));else{const s=e.toISOString();B(s),V(F(s));const a={...m,timestamp:"custom",customDate:s};g(a),t(a)}}catch(e){V(F(z))}},__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,p.jsx)(l.Dropdown,{popoverProps:{placement:"bottom-end",offset:8},renderToggle:({isOpen:e,onToggle:t})=>(0,p.jsx)(l.Button,{onClick:t,"aria-expanded":e,icon:d,style:{position:"absolute",right:"2px",top:"26px",minWidth:"36px",height:"36px",padding:"0"},variant:"tertiary"}),renderContent:({onClose:e})=>(0,p.jsx)("div",{style:{padding:"16px"},children:(0,p.jsx)(l.DateTimePicker,{currentDate:z,onChange:R,is12Hour:!1})})})]})]})]})},m=({taxonomies:e,onChange:t,enabled:s,onToggle:a})=>{const[o,i]=(0,n.useState)(!1),[c,d]=(0,n.useState)({});(0,n.useEffect)((()=>{if(e&&e.length>0){const t={};e.forEach((e=>{t[e.slug]=e.assignedTermIds||[]})),d(t)}}),[e]);const u=e?e.length:0,m=e?e.reduce(((e,t)=>e+t.terms.length),0):0,g=Object.values(c).reduce(((e,t)=>e+t.length),0);return e&&0!==e.length?(0,p.jsxs)("div",{className:"duplicate-post-modal__taxonomy-section",style:{opacity:s?1:.5},children:[(0,p.jsxs)("div",{className:"duplicate-post-modal__section-header",onClick:e=>{e.target.closest(".components-toggle-control")||i(!o)},style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",cursor:"pointer",borderBottom:o?"1px solid rgba(0, 0, 0, 0.1)":"none"},children:[(0,p.jsx)(l.ToggleControl,{checked:s,onChange:a,__nextHasNoMarginBottom:!0}),(0,p.jsxs)("div",{style:{flex:1},children:[(0,p.jsx)("span",{className:"duplicate-post-modal__section-label",children:(0,r.__)("Taxonomies","post-duplicator")}),s&&(0,p.jsxs)("span",{className:"duplicate-post-modal__section-count",children:[" ","(",u," ",(0,r.__)("taxonomies","post-duplicator"),","," ",g||m," ",(0,r.__)("terms","post-duplicator"),")"]})]})]}),o&&(0,p.jsx)("div",{className:"duplicate-post-modal__section-content",style:{padding:"16px"},children:(0,p.jsx)(l.__experimentalVStack,{spacing:"20px",children:e.map((e=>{const s=c[e.slug]||[],a=e.terms.map((e=>e.name)),o=e.terms.filter((e=>s.includes(e.id))).map((e=>e.name));return(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:500},children:e.label}),(0,p.jsx)(l.FormTokenField,{value:o,suggestions:a,onChange:s=>{const a=s.map((t=>{const s=e.terms.find((e=>e.name===t));return s?s.id:null})).filter((e=>null!==e));((e,s)=>{const a={...c,[e]:s};d(a),t&&t(a)})(e.slug,a)},__experimentalExpandOnFocus:!0,__experimentalShowHowTo:!1,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})]},e.slug)}))})})]}):null},g=(0,p.jsx)(c.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(c.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M12 5.5A2.25 2.25 0 0 0 9.878 7h4.244A2.251 2.251 0 0 0 12 5.5ZM12 4a3.751 3.751 0 0 0-3.675 3H5v1.5h1.27l.818 8.997a2.75 2.75 0 0 0 2.739 2.501h4.347a2.75 2.75 0 0 0 2.738-2.5L17.73 8.5H19V7h-3.325A3.751 3.751 0 0 0 12 4Zm4.224 4.5H7.776l.806 8.861a1.25 1.25 0 0 0 1.245 1.137h4.347a1.25 1.25 0 0 0 1.245-1.137l.805-8.861Z"})}),_=({customMeta:e,onChange:t,enabled:s,onToggle:a})=>{const[o,i]=(0,n.useState)(!1),[c,d]=(0,n.useState)([]);(0,n.useEffect)((()=>{e&&e.length>0?d(e.map((e=>({key:e.key,value:e.value,type:e.type||"string",isSerialized:e.isSerialized||!1,originalValue:e.originalValue||e.value,isDeleted:!1})))):d([])}),[e]);const u=c.filter((e=>!e.isDeleted)).length,m=(e,s,a)=>{const o=[...c];if(o[e]={...o[e],[s]:a},"value"===s&&("array"===o[e].type||"object"===o[e].type))try{const t=JSON.parse(a);o[e].type=Array.isArray(t)?"array":"object"}catch(e){}if(d(o),t){const e=o.filter((e=>!e.isDeleted)).map((e=>({key:e.key,value:e.value,type:e.type,isSerialized:e.isSerialized})));t(e)}};return e&&0!==e.length?(0,p.jsxs)("div",{className:"duplicate-post-modal__custom-meta-section",style:{opacity:s?1:.5},children:[(0,p.jsxs)("div",{className:"duplicate-post-modal__section-header",onClick:e=>{e.target.closest(".components-toggle-control")||i(!o)},style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",cursor:"pointer",borderBottom:o?"1px solid rgba(0, 0, 0, 0.1)":"none"},children:[(0,p.jsx)(l.ToggleControl,{checked:s,onChange:a,__nextHasNoMarginBottom:!0}),(0,p.jsxs)("div",{style:{flex:1},children:[(0,p.jsx)("span",{className:"duplicate-post-modal__section-label",children:(0,r.__)("Custom Meta","post-duplicator")}),s&&(0,p.jsxs)("span",{className:"duplicate-post-modal__section-count",children:[" ","(",u," ",(0,r.__)("fields","post-duplicator"),")"]})]})]}),o&&(0,p.jsx)("div",{className:"duplicate-post-modal__section-content",style:{padding:"16px"},children:(0,p.jsxs)(l.__experimentalVStack,{spacing:"16px",children:[c.map(((e,s)=>!e.isDeleted&&(0,p.jsx)("div",{style:{padding:"12px",border:"1px solid rgba(0, 0, 0, 0.1)",borderRadius:"4px"},children:(0,p.jsxs)(l.__experimentalHStack,{spacing:"8px",alignment:"top",children:[(0,p.jsx)("div",{style:{flex:1},children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Key","post-duplicator"),value:e.key,onChange:e=>m(s,"key",e),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})}),(0,p.jsx)("div",{style:{flex:2},children:"array"===e.type||"object"===e.type?(0,p.jsx)(l.TextareaControl,{label:(0,r.__)("Value (JSON)","post-duplicator"),value:e.value,onChange:e=>m(s,"value",e),onBlur:e=>((e,t)=>{const s=c[e];if("array"===s.type||"object"===s.type)try{JSON.parse(t)}catch(t){m(e,"value",s.value)}})(s,e.target.value),rows:6,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}):(0,p.jsx)(l.TextareaControl,{label:(0,r.__)("Value","post-duplicator"),value:e.value,onChange:e=>m(s,"value",e),rows:3,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})}),(0,p.jsx)("div",{children:(0,p.jsx)(l.Button,{icon:g,variant:"tertiary",onClick:()=>(e=>{const s=[...c];if(s[e].isDeleted=!0,d(s),t){const e=s.filter((e=>!e.isDeleted)).map((e=>({key:e.key,value:e.value,type:e.type,isSerialized:e.isSerialized})));t(e)}})(s),label:(0,r.__)("Delete field","post-duplicator"),style:{marginTop:"32px"}})})]})},s))),(0,p.jsx)(l.Button,{variant:"secondary",onClick:()=>{const e=[...c,{key:"",value:"",type:"string",isSerialized:!1,originalValue:"",isDeleted:!1}];d(e)},style:{alignSelf:"flex-start"},children:(0,r.__)("Add Field","post-duplicator")})]})})]}):null},x=({isOpen:e,onClose:t,onDuplicate:s,originalPost:a,defaultSettings:o,postTypes:i,statusChoices:c,siteUrl:d,currentUser:g})=>{const[x,h]=(0,n.useState)(o),[f,y]=(0,n.useState)(!1),[S,v]=(0,n.useState)(!0),[w,j]=(0,n.useState)(!0),[b,C]=(0,n.useState)({}),[N,D]=(0,n.useState)([]),[k,T]=(0,n.useState)(null),[P,M]=(0,n.useState)("idle"),[z,B]=(0,n.useState)(null),[E,V]=(0,n.useState)(""),[I,$]=(0,n.useState)(0),U=(0,n.useRef)(!1);if((0,n.useEffect)((()=>{e&&!U.current&&(h(o),v(!0),j(!0),M("idle"),B(null),V("")),!e&&U.current&&($((e=>e+1)),h(o),v(!0),j(!0),C({}),D([]),T(null)),U.current=e}),[e,o]),(0,n.useEffect)((()=>{if(e&&"idle"===P){if(a?.taxonomies){const e={};a.taxonomies.forEach((t=>{e[t.slug]=t.assignedTermIds||[]})),C(e)}else C({});D(a?.customMeta?a.customMeta.map((e=>({key:e.key,value:e.value,type:e.type||"string",isSerialized:e.isSerialized||!1}))):[]),T(a?.featuredImage?a.featuredImage:null)}}),[e,a,P]),(0,n.useEffect)((()=>{if(k&&e){const e=setTimeout((()=>{const e=document.querySelector(".duplicate-post-modal--has-featured-image.components-modal__frame");e&&e.style.setProperty("--featured-image-url",`url(${k.thumbnail||k.url})`)}),0);return()=>clearTimeout(e)}}),[k,e]),!e)return null;const H=()=>{"duplicating"!==P&&("complete"===P&&(M("idle"),B(null),V("")),t())};return(0,p.jsxs)(l.Modal,{title:a?.title?x.fullTitle?x.fullTitle:`${a.title} ${x.title}`:"",onRequestClose:H,className:"duplicate-post-modal "+(k?"duplicate-post-modal--has-featured-image":""),size:"large",style:{borderRadius:0},children:[(0,p.jsx)("div",{className:"duplicate-post-modal__content",style:{paddingBottom:"idle"===P?"77px":"0"},children:"idle"===P?(0,p.jsxs)(l.__experimentalVStack,{className:"duplicate-post-modal__settings",children:[(0,p.jsx)(u,{settings:x,onSettingsChange:h,postTypes:i,statusChoices:c,originalPost:a,featuredImage:k,onFeaturedImageChange:T},`duplicate-settings-${a?.id||0}-${I}`),a?.taxonomies&&a.taxonomies.length>0&&(0,p.jsx)(m,{taxonomies:a.taxonomies,onChange:e=>{C(e)},enabled:S,onToggle:v}),a?.customMeta&&a.customMeta.length>0&&(0,p.jsx)(_,{customMeta:a.customMeta,onChange:e=>{D(e)},enabled:w,onToggle:j})]}):(0,p.jsx)("div",{className:"duplicate-post-modal__status",children:(0,p.jsxs)("div",{className:"duplicate-post-modal__status-item",children:[k&&(0,p.jsx)("img",{src:k.thumbnail||k.url,alt:"",className:"duplicate-post-modal__status-thumbnail"}),(0,p.jsx)("h3",{className:"duplicate-post-modal__status-title",children:E}),(0,p.jsx)("div",{className:"duplicate-post-modal__status-actions",children:"duplicating"===P?(0,p.jsx)(l.Spinner,{}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(l.Button,{variant:"secondary",onClick:()=>window.open(`${d}/?p=${z}`,"_blank"),children:(0,r.__)("View Post","post-duplicator")}),(0,p.jsx)(l.Button,{variant:"primary",onClick:()=>window.open(`${d}/wp-admin/post.php?post=${z}&action=edit`,"_blank"),children:(0,r.__)("Edit Post","post-duplicator")})]})})]})})}),"idle"===P&&(0,p.jsxs)(l.__experimentalHStack,{alignment:"right",className:"duplicate-post-modal__footer",style:{position:"absolute",bottom:"0px",left:"0",padding:"20px",borderTop:"1px solid rgba(0, 0, 0, 0.1)",background:"#FFF"},children:[(0,p.jsx)(l.Button,{variant:"tertiary",onClick:H,disabled:f,children:(0,r.__)("Cancel","post-duplicator")}),(0,p.jsx)(l.Button,{variant:"primary",onClick:async()=>{y(!0),M("duplicating");const e=x.fullTitle||`${a.title} ${x.title}`;V(e);try{const e={...x,includeTaxonomies:S,includeCustomMeta:w,...S?{taxonomyData:b}:{},customMetaData:N,featuredImageId:k?.id||null};await new Promise(((t,a)=>{s(e,{onSuccess:e=>{B(e.duplicate_id),M("complete"),y(!1),t(e)},onError:e=>{console.error("Error duplicating:",e),M("idle"),y(!1),a(e)}})}))}catch(e){}},disabled:f,isBusy:f,children:f?(0,r.__)("Duplicating...","post-duplicator"):(()=>{const e="same"===x.type?a.type:x.type,t=i[e]||e;return(0,r.__)(`Duplicate ${t}`,"post-duplicator")})()})]})]})};(0,a.registerPlugin)("post-duplicator-button",{render:()=>{const[e,t]=(0,n.useState)(!1),[s,a]=(0,n.useState)(null),[c,d]=(0,n.useState)(!1),[u,m]=(0,n.useState)([]),[g,_]=(0,n.useState)([]),[h,f]=(0,n.useState)(null),[y,S]=(0,n.useState)(null),{postId:v,postType:w,postStatus:j,postTypeLabel:b,postTitle:C,postSlug:N,postDate:D,postAuthor:k,postParent:T,featuredMediaId:P}=(0,i.useSelect)((e=>{const t=e("core/editor"),s=t.getCurrentPost(),a=t.getCurrentPostType(),o=e("core").getPostType(a),l=t.getEditedPostAttribute("author"),i=e("core").getUser(l),n=i?i.name:"Unknown Author",r=t.getEditedPostAttribute("parent")||0,c=t.getEditedPostAttribute("featured_media");return{postId:s.id,postType:a,postStatus:t.getEditedPostAttribute("status"),postTypeLabel:o?o.labels.singular_name:"Post",postTitle:t.getEditedPostAttribute("title"),postSlug:t.getEditedPostAttribute("slug"),postDate:t.getEditedPostAttribute("date"),postAuthor:n,postParent:r,featuredMediaId:c}}),[]);if((0,n.useEffect)((()=>{if(c&&v){const e=async()=>{try{const e=await fetch(`${postDuplicatorVars.restUrl}post-data/${v}`,{headers:{"X-WP-Nonce":postDuplicatorVars.nonce}});if(e.ok){const t=await e.json();m(t.taxonomies||[]),_(t.customMeta||[])}if(T&&T>0)try{const e=postDuplicatorVars.restUrl.replace("post-duplicator/v1/","wp/v2/"),t="page"===w?"pages":"post"===w?"posts":w,s=await fetch(`${e}${t}/${T}`,{headers:{"X-WP-Nonce":postDuplicatorVars.nonce}});if(s.ok){const e=await s.json();S({id:e.id,title:e.title.rendered})}else S(null)}catch(e){console.error("Error fetching parent post:",e),S(null)}else S(null);if(P&&P>0)try{const e=postDuplicatorVars.restUrl.replace("post-duplicator/v1/","wp/v2/"),t=await fetch(`${e}media/${P}`,{headers:{"X-WP-Nonce":postDuplicatorVars.nonce}});if(t.ok){const e=await t.json();f({id:e.id,url:e.source_url,thumbnail:e.media_details?.sizes?.thumbnail?.source_url||e.source_url,alt:e.alt_text||""})}else f(null)}catch(e){console.error("Error fetching featured image:",e),f(null)}else f(null)}catch(e){console.error("Error fetching post data:",e)}};e()}}),[c,v,T,w,P]),"publish"!==j||!v)return null;const M={id:v,title:C,type:w,status:j,slug:N,date:D,author:k,parent:T||0,parentPost:y||null,taxonomies:u,customMeta:g,featuredImage:h};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(o.PluginPostStatusInfo,{className:"m4c-duplicate-post-status-info",children:(0,p.jsxs)("div",{className:"m4c-duplicate-post-wrapper",style:{paddingTop:"16px"},children:[(0,p.jsx)(l.Button,{variant:"secondary",className:"m4c-duplicate-post-gutenberg",onClick:()=>d(!0),disabled:e,children:(0,r.__)(`Duplicate ${b}`,"post-duplicator")}),s&&(0,p.jsx)("div",{className:"m4c-duplicate-error",children:s})]})}),(0,p.jsx)(x,{isOpen:c,onClose:()=>d(!1),onDuplicate:async(e,s)=>{t(!0),a(null),await(async(e,t,s={})=>{const{onSuccess:a,onError:o}=s;try{const s=await fetch(`${postDuplicatorVars.restUrl}duplicate-post`,{method:"POST",headers:{"X-WP-Nonce":postDuplicatorVars.nonce,"Content-Type":"application/json"},body:JSON.stringify({original_id:e,...t})});if(!s.ok){const e=await s.json(),t=new Error(e.message||"Failed to duplicate post");throw t.data=e,t}const o=await s.json();return o.duplicate_id&&a&&a(o),o}catch(e){throw console.error("Error duplicating post:",e),o&&o(e),e}})(v,e,{onSuccess:e=>{t(!1),s?.onSuccess&&s.onSuccess(e)},onError:e=>{a(e.message||e.data?.message||"Failed to duplicate post"),t(!1),s?.onError&&s.onError(e)}})},originalPost:M,defaultSettings:postDuplicatorVars.defaultSettings,postTypes:postDuplicatorVars.postTypes,statusChoices:postDuplicatorVars.statusChoices,siteUrl:postDuplicatorVars.siteUrl,currentUser:postDuplicatorVars.currentUser})]})}})})();